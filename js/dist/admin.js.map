{"version":3,"file":"admin.js","sources":["../src/common/utils/validators.ts","../src/admin/components/PlatformManager.tsx","../src/admin/components/ApplicationsManager.tsx","../src/admin/components/LoanSettingsPage.tsx","../src/common/models/LoanPlatform.ts","../src/common/models/LoanApplication.ts","../src/common/models/LoanVirtualApproval.ts","../src/admin/index.ts"],"sourcesContent":["export const validators = {\n  isValidUrl(string: string): boolean {\n    try {\n      const url = new URL(string);\n      return url.protocol === 'http:' || url.protocol === 'https:';\n    } catch {\n      return false;\n    }\n  },\n\n  isImageUrl(url: string): boolean {\n    if (!this.isValidUrl(url)) return false;\n    const imageExtensions = ['jpg', 'jpeg', 'png', 'gif', 'svg', 'webp'];\n    const pathname = new URL(url).pathname.toLowerCase();\n    const ext = pathname.split('.').pop() || '';\n    return imageExtensions.includes(ext);\n  },\n\n  checkImageAccessible(url: string): Promise<boolean> {\n    return new Promise((resolve) => {\n      const img = new Image();\n      img.onload = () => resolve(true);\n      img.onerror = () => resolve(false);\n      img.src = url;\n    });\n  },\n};\n","// js/src/admin/components/PlatformManager.tsx\nimport Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport Modal, { IInternalModalAttrs } from 'flarum/common/components/Modal';\nimport Stream from 'flarum/common/utils/Stream';\nimport { validators } from '../../common/utils/validators';\nimport m,{Vnode} from 'mithril';\nimport app from 'flarum/admin/app';\nimport LoanPlatform from '../../common/models/LoanPlatform';\n\ntype PlatformEditModalAttrs = IInternalModalAttrs & {\n  platform?: LoanPlatform;\n  onSave: () => void;\n};\n\nclass PlatformEditModal extends Modal<PlatformEditModalAttrs> {\n  private name: any;\n  private logoUrl: any;\n  private previewError: any;\n  private linkUrl: any;\n  private currencyImageUrl: any;\n  oninit(vnode: Vnode) {\n    super.oninit(vnode);\n\n    const platform = this.attrs.platform;\n\n    this.name = Stream(platform ? platform.name() : '');\n    this.logoUrl = Stream(platform ? platform.logoUrl() : '');\n    this.linkUrl = Stream(platform ? platform.sponsorLinkUrl() : '');\n    this.currencyImageUrl = Stream(platform ? platform.currencyImageUrl?.() : '');\n    this.previewError = Stream(false);\n  }\n\n  className() {\n    return 'PlatformEditModal Modal--small';\n  }\n\n  title() {\n    return this.attrs.platform ? '编辑平台' : '新增平台';\n  }\n\n  content() {\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form-group\">\n          <label>平台名称</label>\n          <input\n            className=\"FormControl\"\n            value={this.name()}\n            oninput={(e: InputEvent) => this.name((e.target as HTMLInputElement).value)}\n            placeholder=\"例如：支付宝\"\n          />\n        </div>\n\n        <div className=\"Form-group\">\n          <label>Logo图片链接</label>\n          <input\n            className=\"FormControl\"\n            type=\"url\"\n            value={this.logoUrl()}\n            oninput={(e: InputEvent) => this.handleUrlChange((e.target as HTMLInputElement).value)}\n            placeholder=\"https://example.com/logo.png\"\n          />\n          <div className=\"helpText\">请输入图片的完整URL地址（支持jpg、png、gif、svg格式）</div>\n        </div>\n\n        <div className=\"Form-group\">\n          <label>赞助平台链接（可选）</label>\n          <input\n            className=\"FormControl\"\n            type=\"url\"\n            value={this.linkUrl()}\n            oninput={(e: InputEvent) => this.linkUrl((e.target as HTMLInputElement).value)}\n            placeholder=\"https://example.com/guide\"\n          />\n        </div>\n\n        <div className=\"Form-group\">\n          <label>货币图片链接（可选）</label>\n          <input\n            className=\"FormControl\"\n            type=\"url\"\n            value={this.currencyImageUrl()}\n            oninput={(e: InputEvent) => this.currencyImageUrl((e.target as HTMLInputElement).value)}\n            placeholder=\"https://example.com/currency.png\"\n          />\n          <div className=\"helpText\">用于在前台显示批准额度前的货币图标</div>\n        </div>\n\n        {this.logoUrl() && (\n          <div className=\"Form-group\">\n            <label>图片预览</label>\n            <div className=\"logo-preview\">\n              {!this.previewError() ? (\n                <img\n                  src={this.logoUrl()}\n                  alt=\"Logo预览\"\n                  onload={() => { this.previewError(false); m.redraw(); }}\n                  onerror={() => { this.previewError(true); m.redraw(); }}\n                />\n              ) : (\n                <div className=\"preview-error\">\n                  <i className=\"fas fa-exclamation-triangle\"></i>\n                  <p>图片加载失败，请检查链接是否正确</p>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        <div className=\"Form-group\">\n          <Button\n            className=\"Button Button--primary\"\n            loading={this.loading}\n            disabled={!this.name() || !this.logoUrl() || this.previewError()}\n            onclick={this.save.bind(this)}\n          >\n            保存\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  handleUrlChange(url: string) {\n    this.logoUrl(url);\n    this.previewError(false);\n\n    if (url && !this.isValidUrl(url)) {\n      this.previewError(true);\n    }\n  }\n\n  isValidUrl(string: string) {\n    return validators.isValidUrl(string) && validators.isImageUrl(string);\n  }\n\n  async save(): Promise<void> {\n    if (!this.isValidUrl(this.logoUrl())) {\n      app.alerts.show({ type: 'error' }, '请输入有效的图片链接');\n      return;\n    }\n\n    this.loading = true;\n\n    try {\n      const platform = this.attrs.platform || app.store.createRecord('loan-platforms');\n\n      await platform.save({\n        name: this.name(),\n        logoUrl: this.logoUrl(),\n        sponsorLinkUrl: this.linkUrl(),\n        currencyImageUrl: this.currencyImageUrl()\n      });\n\n      this.attrs.onSave();\n      this.hide();\n      app.alerts.show({ type: 'success' }, '保存成功');\n    } finally {\n      this.loading = false;\n    }\n  }\n}\n\nexport default class PlatformManager extends Component {\n  private loading: boolean = false;\n  private platforms: any[] = [];\n\n  oninit(vnode: Vnode) {\n    super.oninit(vnode);\n\n    this.loading = true;\n    this.platforms = [];\n\n    this.loadPlatforms();\n  }\n\n  async loadPlatforms(): Promise<void> {\n    try {\n      this.platforms = await app.store.find('loan-platforms') as any;\n    } finally {\n      this.loading = false;\n      m.redraw();\n    }\n  }\n\n  view() {\n    return (\n      <div className=\"PlatformManager\">\n        <div className=\"PlatformManager-header\">\n          <h3>贷款平台管理</h3>\n          <Button\n            className=\"Button Button--primary\"\n            onclick={() => this.editPlatform()}\n          >\n            新增平台\n          </Button>\n        </div>\n\n        {this.loading ? (\n          <div>加载中...</div>\n        ) : (\n          <table className=\"PlatformTable\">\n            <thead>\n              <tr>\n                <th>Logo</th>\n                <th>平台名称</th>\n                <th>操作</th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.platforms.map(platform => (\n                <tr key={platform.id()}>\n                  <td>\n                    <img\n                      src={platform.logoUrl()}\n                      style=\"max-width: 50px;\"\n                    />\n                  </td>\n                  <td>{platform.name()}</td>\n                  <td>\n                    <Button\n                      className=\"Button Button--link\"\n                      onclick={() => this.editPlatform(platform)}\n                    >\n                      编辑\n                    </Button>\n                    <Button\n                      className=\"Button Button--link\"\n                      onclick={() => this.deletePlatform(platform)}\n                    >\n                      删除\n                    </Button>\n                    {platform.sponsorLinkUrl?.() && (\n                      <Button\n                        className=\"Button Button--link\"\n                        onclick={() => window.open(platform.sponsorLinkUrl(), '_blank')}\n                      >\n                        打开赞助链接\n                      </Button>\n                    )}\n                    <Button\n                      className=\"Button Button--link\"\n                      onclick={() => this.generateVirtual(platform)}\n                    >\n                      生成虚拟数据\n                    </Button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        )}\n      </div>\n    );\n  }\n\n  editPlatform(platform: any = null) {\n    app.modal.show(PlatformEditModal, {\n      platform,\n      onSave: () => this.loadPlatforms()\n    });\n  }\n\n  async deletePlatform(platform: any) {\n    if (!confirm('确定删除该平台吗？')) return;\n\n    await platform.delete();\n    this.loadPlatforms();\n  }\n\n  async generateVirtual(platform: any) {\n    const count = prompt('请输入要生成的虚拟数据数量', '10');\n    if (!count) return;\n\n    await app.request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/loan-applications/generate-virtual',\n      body: {\n        data: {\n          attributes: {\n            platform_id: platform.id(),\n            count: parseInt(count)\n          }\n        }\n      }\n    });\n\n    app.alerts.show({ type: 'success' }, `成功生成${count}条虚拟数据`);\n  }\n}\n","import Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport app from 'flarum/admin/app';\nimport m,{Vnode} from 'mithril';\nimport LoanApplication from '../../common/models/LoanApplication';\n\nexport default class ApplicationsManager extends Component {\n  private loading: boolean = false;\n  private applications: LoanApplication[] = [];\n\n  oninit(vnode: Vnode) {\n    super.oninit(vnode);\n    this.loading = true;\n    this.applications = [];\n    this.load();\n  }\n\n  async load(): Promise<void> {\n    try {\n      this.applications = await app.store.find('loan-applications', { include: 'user,platform' }) as any;\n    } finally {\n      this.loading = false;\n      m.redraw();\n    }\n  }\n\n  view() {\n    return (\n      <div className=\"ApplicationsManager\">\n        <div className=\"ApplicationsManager-header\">\n          <h3>贷款申请管理</h3>\n          <Button className=\"Button\" onclick={() => this.load()}>刷新</Button>\n        </div>\n\n        {this.loading ? (\n          <div>加载中...</div>\n        ) : (\n          <table className=\"ApplicationTable\">\n            <thead>\n              <tr>\n                <th>用户</th>\n                <th>平台</th>\n                <th>赞助账号</th>\n                <th>还款日期</th>\n                <th>状态</th>\n                <th>批准额度</th>\n                <th>操作</th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.applications.map((appModel: LoanApplication) => (\n                <tr key={appModel.id()}>\n                  <td>{(appModel.user() && (appModel.user() as any).displayName) ? (appModel.user() as any).displayName() : '-'}</td>\n                  <td>{(appModel.platform() && (appModel.platform() as any).name) ? (appModel.platform() as any).name() : '-'}</td>\n                  <td>{appModel.sponsorAccount?.() || '-'}</td>\n                  <td>{this.renderRepaymentCell(appModel.repaymentDate?.())}</td>\n                  <td>{appModel.status()}</td>\n                  <td>{appModel.approvedAmount() || '-'}</td>\n                  <td>\n                    <Button className=\"Button Button--link\" onclick={() => this.review(appModel, 'approved')}>通过</Button>\n                    <Button className=\"Button Button--link\" onclick={() => this.review(appModel, 'rejected')}>拒绝</Button>\n                    <Button className=\"Button Button--link\" onclick={() => this.openSponsorLink(appModel)}>赞助链接</Button>\n                    <Button className=\"Button Button--link\" onclick={() => this.remove(appModel)}>删除</Button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        )}\n      </div>\n    );\n  }\n\n  async review(appModel: LoanApplication, status: 'approved' | 'rejected'): Promise<void> {\n    const attrs: any = { status };\n\n    if (status === 'approved') {\n      const defaultValue = appModel.approvedAmount?.() ? String(appModel.approvedAmount()) : '';\n      const input = prompt('请输入批准额度（整数）', defaultValue);\n      if (input === null) return; // cancelled\n      const amount = parseInt(input, 10);\n      if (isNaN(amount) || amount < 0) {\n        alert('请输入有效的非负整数');\n        return;\n      }\n      attrs.approved_amount = amount;\n    } else {\n      attrs.approved_amount = null;\n    }\n\n    await app.request({\n      method: 'PATCH',\n      url: `${app.forum.attribute('apiUrl')}/loan-applications/${appModel.id()}`,\n      body: { data: { attributes: attrs } }\n    });\n    await this.load();\n  }\n\n  async remove(appModel: LoanApplication): Promise<void> {\n    if (!confirm('确定删除该申请吗？')) return;\n    await appModel.delete();\n    await this.load();\n  }\n\n  openSponsorLink(appModel: LoanApplication) {\n    const platform = appModel.platform() as any;\n    const url = platform && platform.sponsorLinkUrl ? platform.sponsorLinkUrl() : null;\n    if (url) {\n      window.open(url, '_blank');\n    } else {\n      app.alerts.show({ type: 'warning' }, '该平台未配置赞助平台链接');\n    }\n  }\n}\n\n// Helpers\nfunction isOverdueLong(dateStr?: string, maxMonths?: number): boolean {\n  if (!dateStr) return false;\n  const parsed = new Date(dateStr);\n  if (isNaN(parsed.getTime())) return false;\n  const now = new Date();\n  if (!maxMonths || maxMonths <= 0) return now > parsed;\n  const threshold = addMonths(parsed, maxMonths);\n  return now > threshold;\n}\n\nfunction addMonths(date: Date, months: number): Date {\n  const d = new Date(date.getTime());\n  const day = d.getDate();\n  d.setMonth(d.getMonth() + months);\n  if (d.getDate() < day) d.setDate(0);\n  return d;\n}\n\n(ApplicationsManager.prototype as any).renderRepaymentCell = function(dateStr?: string) {\n  const maxMonths = parseInt((app.forum.attribute('loanRepaymentMaxMonths') as any) || '6', 10);\n  const over = isOverdueLong(dateStr, maxMonths);\n  if (!dateStr) return m('span', '-', {} as any);\n  return over ? m('span', { className: 'overdue' } as any, '未还款') : m('span', {} as any, dateStr);\n};\n\n\n\n\n","// js/src/admin/components/LoanSettingsPage.tsx\nimport ExtensionPage from 'flarum/admin/components/ExtensionPage';\nimport app from 'flarum/admin/app';\nimport PlatformManager from './PlatformManager';\nimport ApplicationsManager from './ApplicationsManager';\nimport m, { Vnode } from 'mithril';\n\nexport default class LoanSettingsPage extends ExtensionPage {\n  private activeTab: 'platforms' | 'applications' = 'platforms';\n\n  oninit(vnode: Vnode) {\n    super.oninit(vnode);\n\n    this.activeTab = 'platforms';\n  }\n\n  content() {\n    return (\n      <div className=\"LoanSettingsPage\">\n        <div className=\"LoanSettingsPage-basic\">\n          <h4>基础设置</h4>\n          <form onsubmit={this.saveSettings.bind(this)}>\n            <div className=\"Form-group\">\n              <label>订单 Logo 图片 URL</label>\n              <input\n                className=\"FormControl\"\n                value={this.setting('wusong8899-loan.logo_url')()}\n                oninput={(e: InputEvent) => this.setting('wusong8899-loan.logo_url')((e.target as HTMLInputElement).value)}\n                placeholder=\"https://example.com/logo.png\"\n              />\n            </div>\n            <div className=\"Form-group\">\n              <label>还款日期最大月数</label>\n              <input\n                className=\"FormControl\"\n                type=\"number\"\n                min=\"1\"\n                value={this.setting('wusong8899-loan.repayment_max_months')()}\n                oninput={(e: InputEvent) => this.setting('wusong8899-loan.repayment_max_months')((e.target as HTMLInputElement).value)}\n                placeholder=\"例如：6\"\n              />\n            </div>\n            <div className=\"Form-group\">\n              <button type=\"submit\" className=\"Button Button--primary\">保存</button>\n            </div>\n          </form>\n        </div>\n        <div className=\"LoanSettingsPage-tabs\">\n          <button\n            className={this.activeTab === 'platforms' ? 'active' : ''}\n            onclick={() => { this.activeTab = 'platforms'; m.redraw(); }}\n          >\n            平台管理\n          </button>\n          <button\n            className={this.activeTab === 'applications' ? 'active' : ''}\n            onclick={() => { this.activeTab = 'applications'; m.redraw(); }}\n          >\n            申请管理\n          </button>\n        </div>\n\n        <div className=\"LoanSettingsPage-content\">\n          {this.activeTab === 'platforms' && <PlatformManager />}\n          {this.activeTab === 'applications' && <ApplicationsManager />}\n          <div className=\"LoanSettingsPage-danger\">\n            <h4>危险操作</h4>\n            <button className=\"Button Button--danger\" onclick={this.clearAll.bind(this)}>一键清空申请/审批</button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  async clearAll() {\n    if (!confirm('确定要清空所有申请与虚拟审批数据吗？此操作不可撤销。')) return;\n    try {\n      await app.request({\n        method: 'DELETE',\n        url: app.forum.attribute('apiUrl') + '/loan-clear',\n      });\n      app.alerts.show({ type: 'success' }, '已清空申请与虚拟审批数据');\n    } catch (e) {\n      app.alerts.show({ type: 'error' }, '清空失败 ' + e);\n    }\n  }\n}\n","import Model from 'flarum/common/Model';\n\nexport default class LoanPlatform extends Model {\n  name = Model.attribute<string>('name');\n  logoUrl = Model.attribute<string>('logoUrl');\n  sponsorLinkUrl = Model.attribute<string>('sponsorLinkUrl');\n  currencyImageUrl = Model.attribute<string>('currencyImageUrl');\n  sortOrder = Model.attribute<number>('sortOrder');\n}\n","import Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\nimport LoanPlatform from './LoanPlatform';\n\nexport default class LoanApplication extends Model {\n  sponsorAccount = Model.attribute<string>('sponsorAccount');\n  repaymentDate = Model.attribute<string>('repaymentDate');\n  status = Model.attribute<string>('status');\n  approvedAmount = Model.attribute<number>('approvedAmount');\n  createdAt = Model.attribute<Date>('createdAt');\n  reviewedAt = Model.attribute<Date>('reviewedAt');\n\n  user = Model.hasOne<User>('user');\n  platform = Model.hasOne<LoanPlatform>('platform');\n}\n","import Model from 'flarum/common/Model';\nimport LoanPlatform from './LoanPlatform';\n\nexport default class LoanVirtualApproval extends Model {\n  fakeUsername = Model.attribute<string>('fakeUsername');\n  fakeAvatarUrl = Model.attribute<string>('fakeAvatarUrl');\n  amount = Model.attribute<number>('amount');\n  platform = Model.hasOne<LoanPlatform>('platform');\n}\n","import app from 'flarum/admin/app';\nimport LoanSettingsPage from './components/LoanSettingsPage';\nimport LoanPlatform from '../common/models/LoanPlatform';\nimport LoanApplication from '../common/models/LoanApplication';\nimport LoanVirtualApproval from '../common/models/LoanVirtualApproval';\n\napp.initializers.add('wusong8899-loan', () => {\n  app.extensionData.for('wusong8899-loan').registerPage(LoanSettingsPage);\n  app.store.models['loan-platforms'] = LoanPlatform;\n  app.store.models['loan-applications'] = LoanApplication;\n  app.store.models['loan-virtual-approvals'] = LoanVirtualApproval;\n});\n"],"names":["validators","string","url","imageExtensions","ext","resolve","img","PlatformEditModal","Modal","vnode","platform","Stream","m","e","Button","app","PlatformManager","Component","count","ApplicationsManager","appModel","status","attrs","defaultValue","input","amount","isOverdueLong","dateStr","maxMonths","parsed","now","threshold","addMonths","date","months","d","day","over","LoanSettingsPage","ExtensionPage","LoanPlatform","Model","LoanApplication","LoanVirtualApproval"],"mappings":"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"}